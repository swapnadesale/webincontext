<html>
<head>
	<script>
		
		/*
		 * while node type is 3, look at all the children, print their types, and recurse.
		 * var child = document.body.firstChild.nextSibling; 
			alert("Child of type: " + child.nodeType + ", data: " + child.nodeName);
		 */
		var struct = new Array();
		
		var div = document.createElement('div');
		var nrNodes;
		function run(){
			chrome.extension.onRequest.addListener(function(request, sender, sendResponse){
				div.innerHTML = request.body.replace(/<script(.|\s)*?\/script>|<style(.|\s)*?\/style>/g, '');
				nrNodes = 0;
				struct[request.url] = examineNode(div, "");
			});
		}
		
		function examineNode(node, s) {
			var structNode = false;
			if ((node.nodeName == 'DIV') || (node.nodeName == "NOSCRIPT") ||
			(node.nodeName == "TABLE") || (node.nodeName == "FORM") ||
			(node.nodeName == "UL") || (node.nodeName == "OL")) {
				s += node.nodeName + "(";
				structNode = true;
				nrNodes++;
			}
			
			if(node.nodeType == 1)
				for (var i = 0, l = node.childNodes.length; i < l; i++) {
					s = examineNode(node.childNodes[i], s);
				}

			if(structNode) { s+= ")"; }
			return s;
		}
	</script>
</head>
<body onload="run();">
</body>
</html>