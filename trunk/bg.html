<html>
<head>
	<script LANGUAGE="JavaScript" SRC="history.js"></script>
	<script LANGUAGE="JavaScript" SRC="storeWrapper.js"></script>
	<script LANGUAGE="JavaScript" SRC="stemmer.js"></script>
	<script LANGUAGE="JavaScript" SRC="helperFunctions.js"></script>
	
	<script>
		var log = "Starting.. <br>";
		var detailsPage;
		chrome.tabs.create({url:"SuggestionsDetails.html"}, function(tab) {});
		
		var hist;
		function run(){
			hist = new History({});
			// 1. Load existing state from disk.
			hist.loadParametersFromDisk(function(){
				detailsPage = chrome.extension.getViews()[1];
				// 2. Load (+process&save) yet unprocessed URLs from history.
				hist.loadUnprocessedHistoryEntries(function(){
					hist.historyLoaded();
//					
//					hist.createInvertedIndex(function() {
//						hist.analyzeIndexingPerformance(function(numberRelatedURLs){
//							detailsPage.document.write("Finished analyzing indexing performance. <br><br>");
//							var n = 0, avg = 0;
//                            for (url in numberRelatedURLs) {
//								if(n < 50)
//									detailsPage.document.write(numberRelatedURLs[url] + ": " + url + "<br>");
//								avg += numberRelatedURLs[url]; n++;
//							} 
//							avg /= n;
//							detailsPage.document.write("<br><br><br>Average number of links: " + avg);
//						});
//					});
				});
			});
		}
	</script>
</head>
<body onload="run();">
</body>
</html>